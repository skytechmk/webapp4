import{T as U,s as c,j as e,b as E}from"./index-CC3WzsEc.js";import{R as M,g as _,ad as C,ac as q,D as F,X as V,Q as A,a4 as G,al as H,aj as O}from"./libs-CBAR_Xud.js";import{Q as W}from"./qrcode-DzOCcD1X.js";import"./vendor-BSeQcPOp.js";import"./auth-BXl3LOEh.js";import"./utils-D9li4S3w.js";const{useState:r,useEffect:g,useRef:w,useCallback:X}=M,ie=({event:d,currentUser:B,hostUser:P,onClose:j,t:a})=>{const[l,p]=r(d.media),[f,v]=r(0),[o,T]=r(!0),[z,S]=r("next"),[u,N]=r(!1),[m,y]=r(!0),[R,k]=r(!1),h=w(null),x=w(null),I=w(null),D=P?.tier===U.STUDIO?"#4f46e5":"#000000";g(()=>(c.connect(),c.joinEvent(d.id),c.on("media_uploaded",t=>{p(i=>i.some(n=>n.id===t.id)?i:[t,...i])}),c.on("media_processed",t=>{p(i=>i.map(n=>n.id===t.id?{...n,isProcessing:!1,previewUrl:t.previewUrl,url:t.url||n.url}:n))}),c.on("new_like",t=>{p(i=>i.map(n=>n.id===t.id?{...n,likes:t.likes}:n))}),()=>{c.disconnect()}),[d.id]),g(()=>(o&&l.length>0?h.current=setInterval(()=>{b("next")},4e3):h.current&&clearInterval(h.current),()=>{h.current&&clearInterval(h.current)}),[o,l.length]),g(()=>(m&&(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{y(!1)},3e3)),()=>{x.current&&clearTimeout(x.current)}),[m]);const b=X(t=>{u||l.length===0||(N(!0),S(t),setTimeout(()=>{v(t==="next"?i=>(i+1)%l.length:i=>(i-1+l.length)%l.length),N(!1)},600))},[u,l.length]),$=async t=>{await E.likeMedia(t.id)},L=t=>{const i=document.createElement("a");i.href=t.url,i.download=`snapify_${t.id}`,i.click()},Q=()=>{const t=`${window.location.origin}?event=${d.id}`;navigator.clipboard.writeText(t).then(()=>{alert(a("linkCopied"))})},s=l[f];return s?e.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center overflow-hidden",onClick:()=>y(t=>!t),children:[e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[e.jsx("div",{ref:I,className:`absolute inset-0 transition-all duration-1000 ease-in-out ${u?z==="next"?"opacity-0 scale-110 translate-x-4":"opacity-0 scale-90 -translate-x-4":"opacity-100 scale-100 translate-x-0"}`,children:s.type==="video"?e.jsx("video",{src:s.url,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:"w-full h-full object-contain"}):e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("img",{src:s.previewUrl||s.url,alt:s.caption,className:"w-full h-full object-contain animate-ken-burns",draggable:!1}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/20 animate-ken-burns-overlay"})]})}),e.jsx("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 via-black/70 to-transparent p-8 transition-all duration-300 ${m?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[s.privacy==="private"&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-amber-400 mb-2 text-sm font-bold uppercase tracking-wider",children:[e.jsx("span",{children:"ðŸ”’"})," ",a("private")]}),e.jsx("h2",{className:"text-3xl font-bold text-white mb-2 drop-shadow-lg",children:s.caption||a("untitled")}),e.jsxs("p",{className:"text-white/70 text-lg",children:[a("by")," ",s.uploaderName," â€¢ ",new Date(s.uploadedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white/80",children:[e.jsx(C,{size:20,className:s.likes?"fill-red-500 text-red-500":""}),e.jsx("span",{className:"font-bold",children:s.likes||0})]}),s.comments&&s.comments.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-white/80",children:[e.jsx(q,{size:20}),e.jsx("span",{className:"font-bold",children:s.comments.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),$(s)},className:"p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:e.jsx(C,{size:20,className:s.likes?"fill-red-500 text-red-500":""})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),L(s)},className:"p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:e.jsx(F,{size:20})})]})]})]})}),e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-white/20",children:e.jsx("div",{className:"h-full bg-white transition-all duration-4000 linear",style:{width:o&&!u?"100%":"0%",transition:o&&!u?"width 4s linear":"none"}},f)}),e.jsxs("div",{className:`absolute top-0 left-0 right-0 p-6 flex justify-between items-center transition-all duration-300 ${m?"translate-y-0 opacity-100":"-translate-y-full opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),j()},className:"p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:e.jsx(V,{size:24})}),e.jsxs("div",{className:"text-white/80 font-medium",children:[f+1," / ",l.length]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),k(!0)},className:"p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:e.jsx(A,{size:20})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),Q()},className:"p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:e.jsx(G,{size:20})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),T(!o)},className:"p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",children:o?e.jsx(H,{size:20}):e.jsx(O,{size:20})})]})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),b("prev")},className:"absolute left-6 p-4 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors opacity-0 hover:opacity-100",children:"â†"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),b("next")},className:"absolute right-6 p-4 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors opacity-0 hover:opacity-100",children:"â†’"})]}),R&&e.jsx("div",{className:"absolute inset-0 bg-black/90 flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-white p-8 rounded-3xl text-center max-w-sm mx-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:a("shareLiveWall")}),e.jsx("div",{className:"bg-white p-4 rounded-2xl shadow-lg border border-slate-100 inline-block mb-4",children:e.jsx(W,{value:`${window.location.origin}?event=${d.id}`,size:200,fgColor:D})}),e.jsx("p",{className:"text-slate-600 text-sm mb-4",children:a("scanToView")}),e.jsx("button",{onClick:t=>{t.stopPropagation(),k(!1)},className:"w-full bg-slate-900 text-white py-3 rounded-xl font-bold hover:bg-slate-800 transition-colors",children:a("close")})]})}),e.jsx("style",{children:`
        @keyframes ken-burns {
          0% {
            transform: scale(1) translate(0, 0);
          }
          100% {
            transform: scale(1.1) translate(-1%, -1%);
          }
        }
        
        @keyframes ken-burns-overlay {
          0% {
            opacity: 0;
          }
          50% {
            opacity: 0.3;
          }
          100% {
            opacity: 0;
          }
        }
        
        .animate-ken-burns {
          animation: ken-burns 8s ease-in-out infinite alternate;
        }
        
        .animate-ken-burns-overlay {
          animation: ken-burns-overlay 8s ease-in-out infinite;
        }
      `})]}):e.jsx("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx(_,{size:64,className:"mx-auto mb-4 opacity-50"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:a("noPhotos")}),e.jsx("p",{className:"text-white/60",children:a("beFirst")}),e.jsx("button",{onClick:j,className:"mt-6 px-6 py-3 bg-white/20 rounded-xl hover:bg-white/30 transition-colors",children:a("close")})]})})};export{ie as LiveSlideshow};
