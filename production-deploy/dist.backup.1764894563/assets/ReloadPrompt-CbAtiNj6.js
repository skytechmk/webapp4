import{j as e}from"./index-CC3WzsEc.js";import{R as p,X as h,aq as u,t as g}from"./libs-CBAR_Xud.js";import{u as w}from"./react-egvKCuRq.js";import"./vendor-BSeQcPOp.js";import"./auth-BXl3LOEh.js";import"./utils-D9li4S3w.js";const{useState:c,useEffect:b}=p,C=()=>{const[s]=c(()=>!1),[i,a]=c(!1),{offlineReady:[n,d],needRefresh:[o,f],updateServiceWorker:m}=w({onRegistered(t){t&&setInterval(()=>{document.hidden||t.update()},s?3e4:3e5)},onRegisterError(t){console.warn("Service Worker registration error:",t)}}),x=()=>{d(!1),f(!1)},l=async()=>{a(!0);try{"serviceWorker"in navigator&&await(await navigator.serviceWorker.ready).update(),setTimeout(()=>a(!1),1e3)}catch(t){console.error("Failed to check for updates:",t),a(!1)}};return b(()=>{if(!s)return;const t=r=>{(r.ctrlKey||r.metaKey)&&r.shiftKey&&r.key==="R"&&(r.preventDefault(),l())};return window.forceAppUpdate=l,window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s]),!s&&!n&&!o?null:e.jsxs("div",{className:"fixed bottom-6 right-6 z-[100] bg-slate-900 text-white p-4 rounded-xl shadow-2xl border border-slate-700 flex flex-col gap-3 max-w-sm animate-in slide-in-from-bottom-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-sm",children:n?"App ready to work offline":o?"New content available, click on reload button to update.":"Development Mode"}),!o&&!n&&e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Auto-checks for updates every 5 seconds",s?" â€¢ Ctrl+Shift+R or use forceAppUpdate() in console":""]})]}),!s&&e.jsx("button",{onClick:x,className:"text-slate-400 hover:text-white",children:e.jsx(h,{size:16})})]}),e.jsxs("div",{className:"flex gap-2",children:[o&&e.jsxs("button",{onClick:()=>m(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-colors flex-1",children:[e.jsx(u,{size:16})," Reload & Update"]}),s&&e.jsxs("button",{onClick:l,disabled:i,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-colors flex-1",children:[e.jsx(g,{size:16,className:i?"animate-spin":""}),i?"Checking...":"Check Updates"]})]})]})};export{C as ReloadPrompt};
