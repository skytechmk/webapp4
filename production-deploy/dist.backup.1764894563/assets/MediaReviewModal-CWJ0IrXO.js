import{j as e}from"./index-CC3WzsEc.js";import{R as N,X as y,C as u,W as k,i as z,ap as C,aq as R,ae as L,u as M}from"./libs-CBAR_Xud.js";import"./vendor-BSeQcPOp.js";import"./auth-BXl3LOEh.js";import"./utils-D9li4S3w.js";const{useState:n,useEffect:P,useRef:$}=N,S=({type:l,src:i,onConfirm:h,onRetake:b,onCancel:p,isUploading:a,uploadProgress:d=0,isRegistered:o,t,file:f})=>{const[c,g]=n(""),[r,j]=n("public"),[x,v]=n(0),w=$(null);P(()=>{v(0)},[f,l]);const m=s=>{if(s==="private"&&!o){alert("Please login or register to upload private photos.");return}j(s)};return e.jsxs("div",{className:"fixed inset-0 z-[60] bg-black flex flex-col animate-in fade-in duration-200 h-[100dvh]",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex justify-between items-center z-20 bg-gradient-to-b from-black/60 to-transparent",children:[e.jsx("button",{onClick:p,disabled:a,className:"p-2 bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-colors disabled:opacity-0",children:e.jsx(y,{size:24})}),e.jsx("h3",{className:"text-white font-bold text-lg drop-shadow-md",children:"Preview"}),e.jsx("div",{className:"w-10"})]}),e.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center bg-black relative overflow-hidden",children:l==="video"?e.jsx("video",{src:i,autoPlay:!0,controls:!0,loop:!0,playsInline:!0,muted:!0,className:"max-w-full max-h-full object-contain",style:{width:"auto",height:"auto",maxWidth:"100%",maxHeight:"100%"},onError:s=>{console.error("Video failed to load:",i,s)},onLoadedMetadata:()=>{console.log("Video loaded successfully:",i)}}):e.jsx("img",{ref:w,src:i,alt:"Preview",className:"max-w-full max-h-full object-contain transition-transform duration-300",style:{transform:`rotate(${x}deg)`}})}),e.jsxs("div",{className:"bg-black/80 backdrop-blur-xl p-6 pb-8 z-20 border-t border-white/10",children:[l==="video"&&e.jsxs("div",{className:"flex items-center justify-center mb-4 p-2 bg-amber-500/20 border border-amber-500/30 rounded-lg",children:[e.jsx(u,{size:14,className:"text-amber-400 mr-2 flex-shrink-0"}),e.jsx("p",{className:"text-amber-200 text-xs font-medium text-center",children:t("videoDurationLimit")||"Videos must be 10 seconds or less"})]}),e.jsxs("div",{className:"flex flex-col items-center mb-4",children:[e.jsxs("div",{className:"bg-white/10 rounded-full p-1 flex relative",children:[e.jsxs("button",{onClick:()=>m("public"),className:`flex items-center gap-2 px-4 py-1.5 rounded-full text-xs font-bold transition-all ${r==="public"?"bg-white text-black":"text-white/60 hover:text-white"}`,children:[e.jsx(k,{size:12}),t("public")]}),e.jsxs("button",{onClick:()=>m("private"),className:`flex items-center gap-2 px-4 py-1.5 rounded-full text-xs font-bold transition-all ${r==="private"?"bg-white text-black":o?"text-white/60 hover:text-white":"text-white/20 cursor-not-allowed"}`,children:[e.jsx(z,{size:12}),t("private")]})]}),!o&&e.jsxs("p",{className:"text-[10px] text-white/40 mt-2 flex items-center gap-1",children:[e.jsx(u,{size:10})," ",t("loginRequired")]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-white/50",children:e.jsx(C,{size:16})}),e.jsx("input",{id:"media-caption-input",name:"media-caption",type:"text",value:c,onChange:s=>g(s.target.value),placeholder:t("leaveMessage")||"Add a caption...",className:"w-full bg-white/10 border border-white/20 rounded-xl py-3 pl-10 pr-4 text-white placeholder:text-white/30 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all",autoComplete:"off"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:b,disabled:a,className:"flex-1 py-3.5 bg-white/10 text-white font-bold rounded-xl flex items-center justify-center gap-2 hover:bg-white/20 transition-colors disabled:opacity-50",children:[e.jsx(R,{size:18}),t("retry")||"Retake"]}),e.jsx("button",{onClick:()=>h(c,r,x),disabled:a,className:"flex-[2] py-3.5 bg-indigo-600 text-white font-bold rounded-xl flex items-center justify-center gap-2 hover:bg-indigo-700 transition-colors disabled:opacity-70 shadow-lg shadow-indigo-900/30 relative overflow-hidden",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-indigo-500 transition-all duration-200 ease-out",style:{width:`${d}%`}}),e.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[e.jsx(L,{size:18,className:"animate-spin"}),e.jsxs("span",{children:[d,"%"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:18}),t("upload")||"Upload"]})})]})]})]})};export{S as MediaReviewModal};
