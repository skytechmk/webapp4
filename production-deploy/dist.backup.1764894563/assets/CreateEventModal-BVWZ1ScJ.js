import{j as e,E as F,U as S,b as K}from"./index-CC3WzsEc.js";import{R as X,X as Y,a8 as _,ae as q,x as Q,i as W,Y as Z}from"./libs-CBAR_Xud.js";import"./vendor-BSeQcPOp.js";import"./auth-BXl3LOEh.js";import"./utils-D9li4S3w.js";const{useState:n,useEffect:ee,useRef:te}=X,le=({currentUser:p,onClose:E,onCreate:z,t:s})=>{const[o,T]=n(""),[r,$]=n(""),[h,g]=n(""),[f,m]=n([]),[R,v]=n(!1),[L,d]=n(!1),[i,A]=n(!1),[l,M]=n("Birthday"),[j,x]=n(""),[y,P]=n(""),[N,w]=n(!1),[u,U]=n("30d"),[C,G]=n(30),[k,V]=n("minutes"),b=te(null);ee(()=>{const t=a=>{b.current&&!b.current.contains(a.target)&&d(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const B=async t=>{if(g(t),t.length<3){m([]),d(!1);return}v(!0),d(!0);try{const c=await(await fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(t)}&limit=5&lang=en`)).json();m(c.features||[])}catch(a){console.error("City search failed",a)}finally{v(!1)}},I=t=>{const a=t.properties,c=a.city||a.name,D=a.country,O=D?`${c}, ${D}`:c;g(O),m([]),d(!1)},H=async()=>{if(!o)return;w(!0);const t=i&&r?r:"soon";try{const a=await K.generateEventDescription(o,t,l);x(a)}catch(a){console.error("Failed to generate description",a),x(`Join us for a amazing ${l.toLowerCase()}!`)}finally{w(!1)}},J=t=>{t.preventDefault(),z({title:o,date:i?r:"",city:h.trim(),theme:l,description:j||`Join us for a amazing ${l.toLowerCase()}!`,pin:y,adminOptions:p.role===S.ADMIN?{expiryType:u,durationValue:C,durationUnit:k}:void 0})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden transform transition-all max-h-[90vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:s("createEvent")}),e.jsx("button",{onClick:E,className:"p-2 bg-white rounded-full hover:bg-slate-100 transition-colors",children:e.jsx(Y,{size:20,className:"text-slate-500"})})]}),e.jsxs("form",{onSubmit:J,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:s("eventTitle")}),e.jsx("input",{id:"event-title-input",name:"event-title",type:"text",required:!0,value:o,onChange:t=>T(t.target.value),placeholder:"e.g., Sarah's 30th Birthday",className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",autoComplete:"off"})]}),e.jsxs("div",{className:"relative",ref:b,children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[e.jsx(_,{size:16,className:"text-slate-400"})," ",s("locationCity")]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"event-city-input",name:"event-city",type:"text",value:h,onChange:t=>B(t.target.value),placeholder:"Type to search city (e.g. Skopje)...",className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",autoComplete:"address-level2"}),R&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(q,{size:16,className:"animate-spin text-indigo-500"})})]}),L&&f.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl shadow-xl border border-slate-100 z-20 max-h-48 overflow-y-auto custom-scrollbar",children:f.map((t,a)=>e.jsxs("button",{type:"button",onClick:()=>I(t),className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50 border-b border-slate-50 last:border-0 flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-800",children:t.properties.name}),e.jsx("span",{className:"text-xs text-slate-500",children:[t.properties.state,t.properties.country].filter(Boolean).join(", ")})]},a))}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1 ml-1",children:s("locationHelpText")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:s("eventTheme")}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:F.map(t=>e.jsxs("button",{type:"button",onClick:()=>M(t.id),className:`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all duration-200 min-h-[70px] ${l===t.id?"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":"border-slate-200 text-slate-500 hover:border-slate-300 hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-2xl mb-2",children:t.emoji}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wide text-center leading-tight break-words px-1",children:s(t.labelKey)})]},t.id))})]}),p?.role===S.ADMIN&&e.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100",children:[e.jsxs("label",{className:"block text-sm font-bold text-amber-800 mb-2 flex items-center",children:[e.jsx(Q,{size:16,className:"mr-2"})," ",s("adminSettings")]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:["10d","20d","30d","unlimited","custom"].map(t=>e.jsx("button",{type:"button",onClick:()=>U(t),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors text-left ${u===t?"bg-amber-100 border-amber-300 text-amber-900":"bg-white border-amber-200 text-slate-600 hover:bg-amber-50"}`,children:t==="unlimited"?s("unlimited"):t==="custom"?s("customDuration"):`${t.replace("d","")} ${s("days")}`},t))}),u==="custom"&&e.jsxs("div",{className:"flex gap-2 animate-in fade-in slide-in-from-top-2",children:[e.jsx("input",{id:"admin-duration-value-input",name:"admin-duration-value",type:"number",min:"1",value:C,onChange:t=>G(parseInt(t.target.value)||0),className:"w-1/3 px-3 py-2 border border-slate-300 rounded-lg text-sm bg-white text-slate-900 focus:ring-2 focus:ring-amber-200 outline-none",autoComplete:"off"}),e.jsxs("select",{value:k,onChange:t=>V(t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm bg-white text-slate-900 focus:ring-2 focus:ring-amber-200 outline-none",children:[e.jsx("option",{value:"seconds",children:s("seconds")}),e.jsx("option",{value:"minutes",children:s("minutes")}),e.jsx("option",{value:"hours",children:s("hours")}),e.jsx("option",{value:"days",children:s("days")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[e.jsx(W,{size:16,className:"text-slate-400"})," ",s("optionalPin")]}),e.jsx("input",{id:"event-pin-input",name:"event-pin",type:"text",value:y,onChange:t=>P(t.target.value),placeholder:s("pinDesc"),className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700",children:s("eventDate")}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("div",{className:`w-10 h-5 rounded-full p-1 transition-colors ${i?"bg-indigo-600":"bg-slate-300"}`,children:e.jsx("div",{className:`w-3 h-3 bg-white rounded-full shadow-md transform transition-transform ${i?"translate-x-5":""}`})}),e.jsx("input",{type:"checkbox",checked:i,onChange:t=>A(t.target.checked),className:"hidden"}),e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:s("setDate")})]})]}),i&&e.jsx("input",{id:"event-date-input",name:"event-date",type:"date",value:r,onChange:t=>$(t.target.value),className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all animate-in fade-in slide-in-from-top-1",autoComplete:"bday"})]}),e.jsxs("div",{className:"bg-indigo-50/50 p-4 rounded-xl border border-indigo-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("label",{className:"text-sm font-bold text-indigo-900 flex items-center",children:[e.jsx(Z,{size:14,className:"mr-1.5 text-indigo-500"}),s("aiDesc")]}),e.jsx("button",{type:"button",onClick:H,disabled:!o||N,className:"text-xs bg-white text-indigo-600 px-3 py-1 rounded-full shadow-sm font-bold hover:shadow-md transition-all disabled:opacity-50 disabled:shadow-none",children:s(N?"generating":"autoGenerate")})]}),e.jsx("textarea",{id:"event-description-textarea",name:"event-description",value:j,onChange:t=>x(t.target.value),placeholder:s("aiPlaceholder"),className:"w-full px-3 py-2 bg-white rounded-lg border border-indigo-200 text-sm focus:outline-none focus:border-indigo-400 h-24 resize-none text-slate-900",autoComplete:"off"})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",className:"w-full bg-black text-white py-4 rounded-xl font-bold text-lg hover:bg-slate-800 shadow-lg hover:shadow-xl transition-all transform active:scale-95",children:s("createParty")})})]})]})})};export{le as CreateEventModal};
