import{j as e,E as K,U as D,b as U}from"./index-CQ1VtCuz.js";import{r as a}from"./vendor-Bw8Oeg0g.js";import{X,ad as _,aj as q,F as Q,n as W,a1 as Y}from"./libs-CW3sJYx5.js";const se=({currentUser:r,onClose:E,onCreate:z,t:s})=>{const[i,T]=a.useState(""),[d,$]=a.useState(""),[h,g]=a.useState(""),[f,u]=a.useState([]),[L,v]=a.useState(!1),[A,c]=a.useState(!1),[o,M]=a.useState(!1),[l,P]=a.useState("Birthday"),[j,x]=a.useState(""),[y,R]=a.useState(""),[N,w]=a.useState(!1),[b,G]=a.useState("30d"),[C,V]=a.useState(30),[S,B]=a.useState("minutes"),p=a.useRef(null);a.useEffect(()=>{const t=n=>{p.current&&!p.current.contains(n.target)&&c(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const I=async t=>{if(g(t),t.length<3){u([]),c(!1);return}v(!0),c(!0);try{const m=await(await fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(t)}&limit=5&lang=en`)).json();u(m.features||[])}catch(n){console.error("City search failed",n)}finally{v(!1)}},F=t=>{const n=t.properties,m=n.city||n.name,k=n.country,O=k?`${m}, ${k}`:m;g(O),u([]),c(!1)},H=async()=>{if(!i)return;w(!0);const t=o&&d?d:"soon";try{const n=await U.generateEventDescription(i,t,l);x(n)}catch(n){console.error("Failed to generate description",n),x(`Join us for a amazing ${l.toLowerCase()}!`)}finally{w(!1)}},J=t=>{t.preventDefault(),z({title:i,date:o?d:"",city:h.trim(),theme:l,description:j||`Join us for a amazing ${l.toLowerCase()}!`,pin:y,adminOptions:r.role===D.ADMIN?{expiryType:b,durationValue:C,durationUnit:S}:void 0})};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden transform transition-all max-h-[90vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:s("createEvent")}),e.jsx("button",{onClick:E,className:"p-2 bg-white rounded-full hover:bg-slate-100 transition-colors",children:e.jsx(X,{size:20,className:"text-slate-500"})})]}),e.jsxs("form",{onSubmit:J,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:s("eventTitle")}),e.jsx("input",{id:"event-title-input",name:"event-title",type:"text",required:!0,value:i,onChange:t=>T(t.target.value),placeholder:"e.g., Sarah's 30th Birthday",className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",autoComplete:"off"})]}),e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[e.jsx(_,{size:16,className:"text-slate-400"})," ",s("locationCity")]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"event-city-input",name:"event-city",type:"text",value:h,onChange:t=>I(t.target.value),placeholder:"Type to search city (e.g. Skopje)...",className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",autoComplete:"address-level2"}),L&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(q,{size:16,className:"animate-spin text-indigo-500"})})]}),A&&f.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl shadow-xl border border-slate-100 z-20 max-h-48 overflow-y-auto custom-scrollbar",children:f.map((t,n)=>e.jsxs("button",{type:"button",onClick:()=>F(t),className:"w-full text-left px-4 py-3 text-sm hover:bg-slate-50 border-b border-slate-50 last:border-0 flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-800",children:t.properties.name}),e.jsx("span",{className:"text-xs text-slate-500",children:[t.properties.state,t.properties.country].filter(Boolean).join(", ")})]},n))}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1 ml-1",children:s("locationHelpText")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:s("eventTheme")}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:K.map(t=>e.jsxs("button",{type:"button",onClick:()=>P(t.id),className:`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all duration-200 min-h-[70px] ${l===t.id?"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":"border-slate-200 text-slate-500 hover:border-slate-300 hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-2xl mb-2",children:t.emoji}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wide text-center leading-tight break-words px-1",children:s(t.labelKey)})]},t.id))})]}),(r==null?void 0:r.role)===D.ADMIN&&e.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100",children:[e.jsxs("label",{className:"block text-sm font-bold text-amber-800 mb-2 flex items-center",children:[e.jsx(Q,{size:16,className:"mr-2"})," ",s("adminSettings")]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:["10d","20d","30d","unlimited","custom"].map(t=>e.jsx("button",{type:"button",onClick:()=>G(t),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors text-left ${b===t?"bg-amber-100 border-amber-300 text-amber-900":"bg-white border-amber-200 text-slate-600 hover:bg-amber-50"}`,children:t==="unlimited"?s("unlimited"):t==="custom"?s("customDuration"):`${t.replace("d","")} ${s("days")}`},t))}),b==="custom"&&e.jsxs("div",{className:"flex gap-2 animate-in fade-in slide-in-from-top-2",children:[e.jsx("input",{id:"admin-duration-value-input",name:"admin-duration-value",type:"number",min:"1",value:C,onChange:t=>V(parseInt(t.target.value)||0),className:"w-1/3 px-3 py-2 border border-slate-300 rounded-lg text-sm bg-white text-slate-900 focus:ring-2 focus:ring-amber-200 outline-none",autoComplete:"off"}),e.jsxs("select",{value:S,onChange:t=>B(t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg text-sm bg-white text-slate-900 focus:ring-2 focus:ring-amber-200 outline-none",children:[e.jsx("option",{value:"seconds",children:s("seconds")}),e.jsx("option",{value:"minutes",children:s("minutes")}),e.jsx("option",{value:"hours",children:s("hours")}),e.jsx("option",{value:"days",children:s("days")})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[e.jsx(W,{size:16,className:"text-slate-400"})," ",s("optionalPin")]}),e.jsx("input",{id:"event-pin-input",name:"event-pin",type:"text",value:y,onChange:t=>R(t.target.value),placeholder:s("pinDesc"),className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700",children:s("eventDate")}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("div",{className:`w-10 h-5 rounded-full p-1 transition-colors ${o?"bg-indigo-600":"bg-slate-300"}`,children:e.jsx("div",{className:`w-3 h-3 bg-white rounded-full shadow-md transform transition-transform ${o?"translate-x-5":""}`})}),e.jsx("input",{type:"checkbox",checked:o,onChange:t=>M(t.target.checked),className:"hidden"}),e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:s("setDate")})]})]}),o&&e.jsx("input",{id:"event-date-input",name:"event-date",type:"date",value:d,onChange:t=>$(t.target.value),className:"w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-slate-900 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all animate-in fade-in slide-in-from-top-1",autoComplete:"bday"})]}),e.jsxs("div",{className:"bg-indigo-50/50 p-4 rounded-xl border border-indigo-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("label",{className:"text-sm font-bold text-indigo-900 flex items-center",children:[e.jsx(Y,{size:14,className:"mr-1.5 text-indigo-500"}),s("aiDesc")]}),e.jsx("button",{type:"button",onClick:H,disabled:!i||N,className:"text-xs bg-white text-indigo-600 px-3 py-1 rounded-full shadow-sm font-bold hover:shadow-md transition-all disabled:opacity-50 disabled:shadow-none",children:s(N?"generating":"autoGenerate")})]}),e.jsx("textarea",{id:"event-description-textarea",name:"event-description",value:j,onChange:t=>x(t.target.value),placeholder:s("aiPlaceholder"),className:"w-full px-3 py-2 bg-white rounded-lg border border-indigo-200 text-sm focus:outline-none focus:border-indigo-400 h-24 resize-none text-slate-900",autoComplete:"off"})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",className:"w-full bg-black text-white py-4 rounded-xl font-bold text-lg hover:bg-slate-800 shadow-lg hover:shadow-xl transition-all transform active:scale-95",children:s("createParty")})})]})]})})};export{se as CreateEventModal};
