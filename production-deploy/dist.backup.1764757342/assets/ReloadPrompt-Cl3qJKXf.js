import{j as e}from"./index-CQ1VtCuz.js";import{r as d}from"./vendor-Bw8Oeg0g.js";import{u as p}from"./react-sWsDCr6S.js";import{X as u,av as h,w as g}from"./libs-CW3sJYx5.js";const k=()=>{const[s]=d.useState(()=>!1),[a,i]=d.useState(!1),{offlineReady:[n,c],needRefresh:[o,f],updateServiceWorker:x}=p({onRegistered(t){t&&setInterval(()=>{document.hidden||t.update()},s?3e4:3e5)},onRegisterError(t){console.warn("Service Worker registration error:",t)}}),m=()=>{c(!1),f(!1)},l=async()=>{i(!0);try{"serviceWorker"in navigator&&await(await navigator.serviceWorker.ready).update(),setTimeout(()=>i(!1),1e3)}catch(t){console.error("Failed to check for updates:",t),i(!1)}};return d.useEffect(()=>{if(!s)return;const t=r=>{(r.ctrlKey||r.metaKey)&&r.shiftKey&&r.key==="R"&&(r.preventDefault(),l())};return window.forceAppUpdate=l,window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s]),!s&&!n&&!o?null:e.jsxs("div",{className:"fixed bottom-6 right-6 z-[100] bg-slate-900 text-white p-4 rounded-xl shadow-2xl border border-slate-700 flex flex-col gap-3 max-w-sm animate-in slide-in-from-bottom-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-sm",children:n?"App ready to work offline":o?"New content available, click on reload button to update.":"Development Mode"}),!o&&!n&&e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Auto-checks for updates every 5 seconds",s?" â€¢ Ctrl+Shift+R or use forceAppUpdate() in console":""]})]}),!s&&e.jsx("button",{onClick:m,className:"text-slate-400 hover:text-white",children:e.jsx(u,{size:16})})]}),e.jsxs("div",{className:"flex gap-2",children:[o&&e.jsxs("button",{onClick:()=>x(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-colors flex-1",children:[e.jsx(h,{size:16})," Reload & Update"]}),s&&e.jsxs("button",{onClick:l,disabled:a,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 transition-colors flex-1",children:[e.jsx(g,{size:16,className:a?"animate-spin":""}),a?"Checking...":"Check Updates"]})]})]})};export{k as ReloadPrompt};
